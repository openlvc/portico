<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
<xsl:variable name="cppFailureCount" select="TestRun/Statistics/Failures"/>
<xsl:variable name="cppErrorCount" select="TestRun/Statistics/Errors"/>
<xsl:variable name="failureCount" select="$cppFailureCount + $cppErrorCount"/>
<xsl:variable name="successCount" select="count(TestRun/SuccessfulTests/Test)"/>
<html>
<head>
	<title>Portico C++ Unit Test Results</title>
</head>
<body style="font-family: sans-serif; font-size: small;">
	<h1>Results for Portico C++ Unit Tests</h1>
	<table border="0" width="100%">
		<tr>
			<xsl:choose>
				<xsl:when test="$failureCount &gt; 0">
					<td bgcolor="#ff0000" style="padding: 5px; color: #ffffff;">	
						<b><xsl:value-of select="$failureCount"/> test(s) failed</b>
					</td>
				</xsl:when>
				<xsl:otherwise>
					<td bgcolor="#00ff00" style="padding: 5px; color: #ffffff;">	
						<b>All tests passed</b>
					</td>
				</xsl:otherwise>
			</xsl:choose>
		</tr>
	</table>

	<h2>Overview</h2>
	<table border="0" cellpadding="1px">
	<xsl:for-each select="TestRun/Statistics">
		<tr>
			<td width="200px"><b>Total Tests:</b></td>
			<td width="200px"><xsl:value-of select="Tests"/></td>
		</tr>
		<tr>
			<xsl:choose>
			<xsl:when test="$failureCount &gt; 0">
			<td style="color: #ff0000;">
				<b>Failures Total:</b>
			</td>
			<td style="color: #ff0000;">
				<xsl:value-of select="FailuresTotal"/>
			</td>
			</xsl:when>
			<xsl:otherwise>
			<td style="color: #00ff00;">
				<b>Failures Total:</b>
			</td>
			<td style="color: #00ff00;">
				<xsl:value-of select="FailuresTotal"/>
			</td>
			</xsl:otherwise>
			</xsl:choose>
		</tr>
		<tr>
			<td><b>Errors:</b></td>
			<td><xsl:value-of select="Errors"/></td>
		</tr>
		<tr>
			<td><b>Failures:</b></td>
			<td><xsl:value-of select="Failures"/></td>
		</tr>
	</xsl:for-each>
	</table>	
	<hr/>
	<h2>Failed Tests</h2>
	<xsl:choose>
	<xsl:when test="$failureCount &gt; 0">
	<table width="100%" cellpadding="2px" style="border-width: 1px; border-style: solid; border-collapse: collapse;">
		<tr align="left">
			<th style="color: #ffffff; background-color: #ff0000; border-width: 1px; border-style: inset;">Name</th>
			<th style="color: #ffffff; background-color: #ff0000; border-width: 1px; border-style: inset;">Failure Type</th>
			<th style="color: #ffffff; background-color: #ff0000; border-width: 1px; border-style: inset;">Test File</th>
			<th style="color: #ffffff; background-color: #ff0000; border-width: 1px; border-style: inset;">Line No</th>
			<th width="40%" style="color: #ffffff; background-color: #ff0000; border-width: 1px; border-style: inset;">Message</th>
		</tr>
	<xsl:for-each select="TestRun/FailedTests/FailedTest">
		<tr valign="top">
			<td style="color: #ff0000; border-width: 1px; border-style: inset;"><xsl:value-of select="Name"/></td>
			<td style="border-width: 1px; border-style: inset;"><xsl:value-of select="FailureType"/></td>
			<td style="border-width: 1px; border-style: inset;"><xsl:value-of select="Location/File"/></td>
			<td style="border-width: 1px; border-style: inset;"><xsl:value-of select="Location/Line"/></td>
			<td width="40%" style="border-width: 1px; border-style: inset;"><pre><xsl:value-of select="Message"/></pre></td>
		</tr>
	</xsl:for-each>		
	</table>	
	</xsl:when>
	<xsl:otherwise>
	No failed tests
	</xsl:otherwise>
	</xsl:choose>
	<br/>
	<br/>
	<hr/>
	<h2>Successful Tests</h2>
	<xsl:choose>
	<xsl:when test="$successCount &gt; 0">
	<ul>
	<xsl:for-each select="TestRun/SuccessfulTests/Test">
		<li><xsl:value-of select="Name"/></li>
	</xsl:for-each>
	</ul>
	</xsl:when>
	<xsl:otherwise>
	No successful tests
	</xsl:otherwise>
	</xsl:choose>
	<br/>
	<br/>
	<hr/>
	<div align="center" style="font-size: x-small">Page automatically generated by the Portico C++ testing framework. </div>
</body>

</html>
</xsl:template>

</xsl:stylesheet>
